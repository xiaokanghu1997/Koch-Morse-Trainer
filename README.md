# Koch - 摩尔斯电码训练器

基于Koch方法的摩尔斯电码学习工具

## 版本信息
- **当前版本**: 1.2.5
- **作者**: Xiaokang HU
- **更新日期**: 2025-12-15

## 功能特性

### 核心功能
- ✅ 支持40个课程的渐进式学习
- ✅ 单字符音频练习（41个字符）
- ✅ 实时准确率检查
- ✅ 学习进度自动保存
- ✅ 练习文本高亮显示（正确/错误/缺失/多余）
- ✅ 深色/浅色主题切换
- ✅ 窗口透明度调节
- ✅ 摩尔斯电码波形图可视化

### 音频播放
- 🎵 **进度条拖动**：支持直接拖动进度条跳转到任意位置
- 🎵 **设备热插拔**：自动适配耳机/蓝牙音箱插拔
- 🎵 **播放状态保持**：设备切换时保持播放位置
- 🎵 **音量调节**：支持在设置面板调节音频音量

### 统计功能
- 📊 练习时长、次数和准确率统计
- 📅 日历热力图显示每日练习活动
- 📈 交互式图表展示（基于Echarts）
- 🕐 多种时间聚合模式（小时/天/月/年）
- 🎯 课程级和全局统计数据
- 💾 自动保存统计数据到 JSON 文件

### 日志系统
- 📝 完整的日志记录功能
- 📝 自动轮转（最大 10MB，保留 3 个备份）
- 📝 记录应用启动、课程切换、音频加载、错误等关键事件

## 使用方法

1. 运行 `Koch_Setup_v1.2.5.exe ` 安装软件
2. 运行 `Create Koch Morse Training Materials.exe` 生成训练材料
3. 运行 `Koch.exe` 启动训练器
4. 从第1节课开始，逐步提升

## 项目结构

```
Koch/
├── Koch.exe                                  # 主程序
├── Koch.py                                   # 主程序源代码
├── Config.py                                 # 配置管理模块
├── Statistics.py                             # 统计数据管理模块
├── Statistics_Window.py                      # 统计窗口显示模块
├── Create Koch Morse Training Materials.exe  # 资源生成工具
├── Create_Koch_Morse_Training_Materials.py   # 资源生成工具源代码
├── Statistics.json                           # 练习结果统计信息（不包含在Git中）
├── Koch.log                                  # 日志文件（不包含在Git中）
├── Resource/                                 # 训练资源目录（不包含在Git中）
│   ├── Character/                            # 单字符音频（41个文件）
│   └── Lesson-XX/                            # 课程音频和文本（40个课程）
├── Logo/                                     # 应用图标
│   ├── logo_light.png                        # 浅色主题图标
│   └── logo_dark.png                         # 深色主题图标
├── Echarts/                                  # 图表HTML模板
│   ├── calendar.html                         # 日历热力图模板
│   ├── table.html                            # 统计图表模板
│   └── echarts.min.js                        # Echarts配置文件
└── Installer/                                # 安装程序构建文件
    ├── Build_Installer.bat                   # 构建脚本
    ├── setup.iss                             # Inno Setup 配置
    ├── logo.ico                              # 安装程序图标
    └── logo.bmp                              # 安装向导图片
```

## 快捷键

- **Ctrl+Enter**: 检查结果 / 下一个练习
- **Ctrl+R**: 重播文本音频
- **Space**: 播放/暂停文本音频

## 版本历史

### v1.2.6 (2025-12-22)
- ✨ 新增功能
  - 📈 支持通过设置面板开关，实时显示音频播放的摩尔斯码波形
- 🐛 修复
  - 字符音频和文本音频同时播放问题

### v1.2.5 (2025-12-15)
- 🐛 修复
  - 统计窗口中平均准确率不一致
  - 音频播放进度条与进度标签不一致

### v1.2.4 (2025-12-12)
- ✨ 新增功能
  - 🖥️ 设置面板集中调节音量、透明度和主题
  - 🎵 通过滑块实时调节音频的音量（支持音量保存）
  - 🎨 通过滑块精细调节透明度（在10~100%任意控制）
  - 🌓 主题设置保存（应用启动时自动加载上次的主题设置）
- 🐛 修复
  - 统计窗口出现滚动条的问题
- 🔧 技术改进
  - 使用 Slider 控制音频播放、音量和透明度，支持交互式拖动
  - 通过 QSettings 实现音量和主题的保存及再次加载

### v1.2.3 (2025-12-04)
- ✨ 新增功能
  - 🎵 音频设备热插拔支持（自动适配耳机/蓝牙音箱）
  - 🎨 进度条拖动功能（支持跳转到任意位置）
  - 📝 完整的日志系统（自动轮转、分级记录）
- 🐛 修复
  - 音频设备切换时播放器状态丢失
- 🔧 技术改进
  - 重构进度条为 QSlider，支持交互式拖动
  - 使用 QMediaDevices 监听音频设备变化
  - 新增 Python logging 日志系统

### v1.2.0 (2025-11-28)
- ✨ 新增功能
  - 📅 日历热力图，直观显示每日练习活动
  - 📊 交互式统计图表（基于Echarts）
  - 🕐 多种时间聚合模式（小时/天/月/年）
  - ⏱️ 练习时长精确追踪
  - 🎨 主题切换时标题栏颜色同步（Windows 11）
  - 🖼️ 支持浅色/深色主题专用 Logo
- 🐛 修复
  - 改进统计窗口交互性能


### v1.1.0 (2025-11-17)
- ✨ 新增统计功能
  - 记录每次练习的准确率
  - 统计练习时长、次数和准确率
  - 课程练习数据展示
  - 总体统计数据展示
- 🎨 优化界面布局
- 📊 新增统计窗口

### v1.0.0 (2025-11-10)
- 🎉 初始版本
- 实现Koch方法核心功能
- 支持40个课程渐进学习
- 单字符音频练习
- 实时准确率检查

## 技术栈

- **语言**: Python 3.10
- **GUI框架**: PySide6 (Qt for Python)
- **UI组件库**: qfluentwidgets
- **音频处理**: scipy, numpy
- **数据可视化**: Echarts 6.0
- **日志系统**: Python logging
- **打包工具**: PyInstaller, Inno Setup

## 开发构建

### 环境要求
```bash
pip install PySide6 qfluentwidgets scipy numpy
```

### 构建安装程序
```bash
# 运行构建脚本（需要安装 PyInstaller 和 Inno Setup）
Build_Installer.bat
```

## 故障排查

### 日志文件位置
- **路径**: `D:\Program Files (x86)\Koch\Koch.log`
- **格式**: 时间戳 - 日志级别 - 消息内容
- **轮转**: 最大 10MB，保留 3 个备份

## 许可证

MIT License

## 联系方式

- GitHub: [@xiaokanghu1997](https://github.com/xiaokanghu1997)
