# 更新日志

所有重要的项目变更都会记录在此文件中。

---

## [1.2.5] - 2025-12-15

### 修复
- 🐛 统计窗口中平均准确率不一致
- 🐛 音频播放进度条与进度标签不一致

### 文件变更
- **修改**
  - `Koch.py` - 修复音频播放逻辑
  - `Statistics.py` - 修复平均准确率计算方法

---

## [1.2.4] - 2025-12-12

### 新增
- 🖥️ **设置面板**
  - 优化了界面布局，新增设置选项
  - 可通过设置面板实现音量、透明度和主题控制
- 🎵 **音量调节**
  - 实时调节音频的音量
  - 音量设置自动保存，重新启动后恢复之前音量
  - 音频设备切换后恢复音量
- 🎨 **透明度调节**
  - 将透明度开关改为滑块控制（10~100%）
  - 实时显示透明度百分比
  - 支持精细调节窗口透明度
- 🌓 **主题设置保存**
  - 深色/浅色主题设置自动保存
  - 应用启动时自动加载上次的主题设置

### 改进
- 🎨 **界面优化**
  - 集中在设置面板实现音量、透明度和主题控制
- 🔧 **代码优化**
  - 通过滑块控件实现对透明度的精细调节
  - 采用 Slider 替换原来的 QSlider
- 💾 **设置管理优化**
  - 保存设置的音量和主题
  - 再次打开软件时直接从 QSettings 加载保存信息

### 修复
- 🐛 统计窗口出现滚动条的问题

### 文件变更
- **修改**
  - `Koch.py` - 新增设置面板，新增音量控制，改进透明度和主题设置
  - `Create_Koch_Morse_Training_Materials.py` - 生成材料时重置音量和主题
  - `Statistics_Window.py` - 设置透明度和主题与主窗口统一

---

## [1.2.3] - 2025-12-04

### 新增
- 🎵 **音频设备热插拔支持**
  - 监听系统音频设备变化（耳机插拔、蓝牙连接等）
  - 自动切换到新的音频输出设备
  - 保持播放状态和播放位置
- 🎨 **进度条交互增强**
  - 使用 QSlider 替代 ProgressBar，支持拖动跳转
  - 拖动时实时显示目标时间
  - 拖动过程中暂停位置更新，释放后跳转
  - 自定义进度条样式，适配 QFluentWidgets 主题
- 📝 **日志系统**
  - 新增完整的日志记录功能（基于 Python logging 模块）
  - 日志自动轮转（最大 10MB，保留 3 个备份）
  - 文件日志记录所有级别，控制台仅显示警告及以上
  - 记录应用启动、课程切换、音频加载、错误等关键事件

### 改进
- 🔧 **代码优化**
  - 重构进度条更新逻辑，分离拖动状态和播放状态
  - 优化音频设备管理，使用 QMediaDevices 监听设备变化
  - 日志文件保存在安装目录（`Koch.log`）

### 修复
- 🐛 音频设备切换时播放器状态丢失

### 文件变更
- **修改**
  - `Config.py` - 添加日志配置
  - `Koch.py` - 添加音频设备热插拔支持，进度条交互增强，日志记录
  - `Statistics.py` - 添加日志记录
  - `Statistics_Window.py` - 添加日志记录

---

## [1.2.0] - 2025-11-28

### 新增
- ✨ **日历热力图统计**
  - 按年份显示每日练习活动热力图
  - 支持多年份数据查看
  - 显示年度总练习次数、总时长和平均准确率
- 📊 **交互式统计图表**（基于Echarts）
  - 全局统计模式：对比所有课程的准确率和练习次数
  - 单课程统计模式：展示历史练习记录
  - 支持多种时间聚合模式（小时/天/月/年）

### 改进
- 🎯 **统计图表优化**
  - 新增日历热力图数据生成方法
  - 改用 Echarts 绘制统计图表
- 📦 **架构重构**
  - 改进配置管理（`Config.py`）
  - 引入 `echarts_dir` 路径管理
- 🖥️ **界面优化**
  - 统计窗口支持日历/图表切换
  - 优化统计信息显示布局

### 文件变更
- **新增**
  - `Echarts/calendar.html` - 日历热力图 HTML 模板
  - `Echarts/table.html` - 统计图表 HTML 模板
  - `Echarts/echarts.min.js` - Echarts 配置文件
- **修改**
  - `Statistics.py` - 新增日历热力图数据生成、时间聚合方法
  - `Statistics_Window.py` - 完全重构，使用 Echarts 渲染图表
  - `Config.py` - 新增 `echarts_dir` 和 `get_echarts_html()` 方法
  - `Build_Installer.bat` - 添加 Echarts 文件夹打包
  - `setup.iss` - 更新版本号和作者信息

---

## [1.1.0] - 2025-11-17

### 新增
- ✨ **统计功能模块**
  - 自动记录每次练习的准确率和时长
  - 统计练习时间、次数和准确率
  - 显示总体情况和各课程详细数据
- 📊 **统计窗口界面**
  - 总体统计页面
  - 课程详情页面
  - 基于 Matplotlib 的数据可视化

### 改进
- 🎨 优化主界面按钮布局
- ⏱️ 添加练习计时功能
- 💾 统计数据自动保存到 JSON 文件

### 文件变更
- **新增**
  - `Statistics.py` - 统计数据管理模块
  - `StatisticsWindow.py` - 统计窗口界面
- **修改**
  - `Koch.py` - 集成统计功能
  - `Config.py` - 更新相关配置

---

## [1.0.0] - 2025-11-10

### 新增
- 🎉 **Koch方法摩尔斯电码训练器核心功能**
  - 40个课程的渐进式学习系统
  - 单字符音频练习（41个字符）
  - 实时准确率检查和结果高亮
  - 学习进度自动保存功能
- 🎨 **界面功能**
  - 深色/浅色主题切换
  - 窗口透明度调节
  - 键盘快捷键支持（Ctrl+Enter、Ctrl+R、Space）
- ⚙️ **配置选项**
  - 支持自定义字符速率（WPM）
  - 支持自定义有效速率（Farnsworth间隔）
  - 支持自定义音调频率
  - 4种字符频率分布模式
- 🎵 **音频生成**
  - 基于 LCWO 标准的摩尔斯电码音频生成
  - 正弦波音调 + 淡入淡出效果
  - 自动生成练习音频和文本文件

### 文件
- `Koch.py` - 主训练器程序
- `Config.py` - 配置管理模块
- `Create_Koch_Morse_Training_Materials.py` - 训练材料生成工具
- `Build_Installer.bat` - 构建脚本
- `setup.iss` - Inno Setup 安装程序配置